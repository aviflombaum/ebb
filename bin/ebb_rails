#!/usr/bin/env ruby
require File.dirname(__FILE__) + '/../ruby_lib/ebb'
require 'optparse'
require 'rubygems'
require 'rack'

module Rack
  module Adapter
    autoload :Rails, Ebb::LIBDIR + '/rack/adapter/rails'
  end
end

Ebb::Runner.new('ebb_rails') do
  def add_extra_options(parser, options)
    # defaults for ebb_rails
    options.update(
      :environment => 'development',
      :port => 3000
    )
    
    parser.on("-e", "--env ENV", 
            "Rails environment (default: development)") do |env| 
      options[:environment] = env
    end
  end
  
  def app(options)
    Rack::Adapter::Rails.new(options)
  end
end